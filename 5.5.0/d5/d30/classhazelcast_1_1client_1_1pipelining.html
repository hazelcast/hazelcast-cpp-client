<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hazelcast C++ Client: hazelcast::client::pipelining&lt; E &gt; Class Template Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../IMDG_blue_logo_square_RGB-dark_200px.png"/></td>
  <td id="projectalign">
   <div id="projectname">Hazelcast C++ Client
   </div>
   <div id="projectbrief">Hazelcast C++ Client Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('d5/d30/classhazelcast_1_1client_1_1pipelining.html','../../','d6/d42/classhazelcast_1_1client_1_1pipelining-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">hazelcast::client::pipelining&lt; E &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>@Beta  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d7/de5/pipelining_8h_source.html">pipelining.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;"><span class="dynarrow"><span class="arrowhead closed"></span></span>Inheritance diagram for hazelcast::client::pipelining&lt; E &gt;:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d5/d30/classhazelcast_1_1client_1_1pipelining.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abd432787657cf409f2a3c18903a2fbfd" id="r_abd432787657cf409f2a3c18903a2fbfd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; boost::optional&lt; E &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd432787657cf409f2a3c18903a2fbfd">results</a> ()</td></tr>
<tr class="memdesc:abd432787657cf409f2a3c18903a2fbfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the results.  <br /></td></tr>
<tr class="memitem:a803076f7a4337b890c27ccba5a6bbb3d" id="r_a803076f7a4337b890c27ccba5a6bbb3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a803076f7a4337b890c27ccba5a6bbb3d">add</a> (boost::future&lt; boost::optional&lt; E &gt; &gt; future)</td></tr>
<tr class="memdesc:a803076f7a4337b890c27ccba5a6bbb3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a future to this Pipelining or blocks until there is capacity to add the future to the Pipelining.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-static-methods" class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ae0f90541032e3ce48b82c98f9a7d3d07" id="r_ae0f90541032e3ce48b82c98f9a7d3d07"><td class="memItemLeft" align="right" valign="top">static std::shared_ptr&lt; pipelining &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae0f90541032e3ce48b82c98f9a7d3d07">create</a> (int depth)</td></tr>
<tr class="memdesc:ae0f90541032e3ce48b82c98f9a7d3d07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a Pipelining with the given depth.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename E&gt;<br />
class hazelcast::client::pipelining&lt; E &gt;</div><p>@Beta </p>
<p>The Pipelining can be used to speed up requests. It is build on top of asynchronous requests like e.g. <code><a class="el" href="">IMap#getAsync(const K&amp;)</a></code> or any other asynchronous call.</p>
<p>The main purpose of the Pipelining is to control the number of concurrent requests when using asynchronous invocations. This can be done by setting the depth using the constructor. So you could set the depth to e.g 100 and do 1000 calls. That means that at any given moment, there will only be 100 concurrent requests.</p>
<p>It depends on the situation what the optimal depth (number of invocations in flight) should be. If it is too high, you can run into memory related problems. If it is too low, it will provide little or no performance advantage at all. In most cases a Pipelining and a few hundred map/cache puts/gets should not lead to any problems. For testing purposes we frequently have a Pipelining of 1000 or more concurrent requests to be able to saturate the system.</p>
<p>The Pipelining can't be used for transaction purposes. So you can't create a Pipelining, add a set of asynchronous request and then not call <code><a class="el" href="#abd432787657cf409f2a3c18903a2fbfd">results()</a></code> to prevent executing these requests. Invocations can be executed before the <code><a class="el" href="#abd432787657cf409f2a3c18903a2fbfd">results()</a></code> is called.</p>
<p>The Pipelining isn't threadsafe. So only a single thread should add requests to the Pipelining and wait for results.</p>
<p>Currently all <code><a class="el" href="">ICompletableFuture</a></code> and their responses are stored in the Pipelining. So be careful executing a huge number of request with a single Pipelining because it can lead to a huge memory bubble. In this cases it is better to periodically, after waiting for completion, to replace the Pipelining by a new one. In the future we might provide this as an out of the box experience, but currently we do not.</p>
<p>A Pipelining provides its own backpressure on the system. So there will not be more in flight invocations than the depth of the Pipelining. This means that the Pipelining will work fine when backpressure on the client/member is disabled (default). Also when it is enabled it will work fine, but keep in mind that the number of concurrent invocations in the Pipelining could be lower than the configured number of invocation of the Pipelining because the backpressure on the client/member is leading.</p>
<p>The Pipelining has been marked as Beta since we need to see how the API needs to evolve. But there is no problem using it in production. We use similar techniques to achieve high performance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">&lt;E&gt;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/de5/pipelining_8h_source.html#l00081">81</a> of file <a class="el" href="../../d7/de5/pipelining_8h_source.html">pipelining.h</a>.</p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="a803076f7a4337b890c27ccba5a6bbb3d" name="a803076f7a4337b890c27ccba5a6bbb3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a803076f7a4337b890c27ccba5a6bbb3d">&#9670;&#160;</a></span>add()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename E&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">hazelcast::client::pipelining</a>&lt; E &gt;::add </td>
          <td>(</td>
          <td class="paramtype">boost::future&lt; boost::optional&lt; E &gt; &gt;</td>          <td class="paramname"><span class="paramname"><em>future</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a future to this Pipelining or blocks until there is capacity to add the future to the Pipelining. </p>
<p>This call blocks until there is space in the Pipelining, but it doesn't mean that the invocation that returned the ICompletableFuture got blocked.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">future</td><td>the future to add. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">null_pointer</td><td>if future is null. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/de5/pipelining_8h_source.html#l00136">136</a> of file <a class="el" href="../../d7/de5/pipelining_8h_source.html">pipelining.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  137</span>    {</div>
<div class="line"><span class="lineno">  138</span>        down();</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>        futures_.push_back(<a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">future</a>.share());</div>
<div class="line"><span class="lineno">  141</span>    }</div>
<div class="ttc" id="aclasshazelcast_1_1client_1_1pipelining_html"><div class="ttname"><a href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">hazelcast::client::pipelining</a></div><div class="ttdoc">@Beta</div><div class="ttdef"><b>Definition</b> <a href="../../d7/de5/pipelining_8h_source.html#l00081">pipelining.h:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0f90541032e3ce48b82c98f9a7d3d07" name="ae0f90541032e3ce48b82c98f9a7d3d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0f90541032e3ce48b82c98f9a7d3d07">&#9670;&#160;</a></span>create()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename E&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; pipelining &gt; <a class="el" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">hazelcast::client::pipelining</a>&lt; E &gt;::create </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>depth</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a Pipelining with the given depth. </p>
<p>We use this factory create method and hide the constructor from the user, because the private <code><a class="el" href="">up()</a></code> and <code><a class="el" href="#aeed5127181911524bbdb8211f20a2094">down()</a></code> methods of this class may be called from the executor thread, and we need to make sure that the <span class="tt">Pipelining</span> instance is not destructed when these methods are accessed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">depth</td><td>the maximum number of concurrent calls allowed in this Pipelining. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">illegal_argument</td><td>if depth smaller than 1. But if you use depth 1, it means that every call is sync and you will not benefit from pipelining at all. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/de5/pipelining_8h_source.html#l00099">99</a> of file <a class="el" href="../../d7/de5/pipelining_8h_source.html">pipelining.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  100</span>    {</div>
<div class="line"><span class="lineno">  101</span>        <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">util::Preconditions::check_positive</a>(<a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">depth</a>, <span class="stringliteral">&quot;depth must be positive&quot;</span>);</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">std::shared_ptr&lt;pipelining&gt;</a>(<span class="keyword">new</span> pipelining(<a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">depth</a>));</div>
<div class="line"><span class="lineno">  104</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="abd432787657cf409f2a3c18903a2fbfd" name="abd432787657cf409f2a3c18903a2fbfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd432787657cf409f2a3c18903a2fbfd">&#9670;&#160;</a></span>results()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename E&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; boost::optional&lt; E &gt; &gt; <a class="el" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">hazelcast::client::pipelining</a>&lt; E &gt;::results </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the results. </p>
<p>The results are returned in the order the requests were done. </p>
<p>This call waits till all requests have completed.</p>
<dl class="section return"><dt>Returns</dt><dd>the List of results. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IException</td><td>if something fails getting the results. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/de5/pipelining_8h_source.html#l00116">116</a> of file <a class="el" href="../../d7/de5/pipelining_8h_source.html">pipelining.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  117</span>    {</div>
<div class="line"><span class="lineno">  118</span>        <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">std::vector&lt;boost::optional&lt;E&gt;</a>&gt; <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">result</a>;</div>
<div class="line"><span class="lineno">  119</span>        <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">result</a>.reserve(futures_.size());</div>
<div class="line"><span class="lineno">  120</span>        <span class="keyword">auto</span> <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">result_futures</a> = <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">when_all</a>(futures_.begin(), futures_.end());</div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">f</a> : <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">result_futures</a>.get()) {</div>
<div class="line"><span class="lineno">  122</span>            <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">result</a>.emplace_back(<a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">f</a>.get());</div>
<div class="line"><span class="lineno">  123</span>        }</div>
<div class="line"><span class="lineno">  124</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">result</a>;</div>
<div class="line"><span class="lineno">  125</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>hazelcast/include/hazelcast/client/<a class="el" href="../../d7/de5/pipelining_8h_source.html">pipelining.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>hazelcast</b></li><li class="navelem"><b>client</b></li><li class="navelem"><a href="../../d5/d30/classhazelcast_1_1client_1_1pipelining.html">pipelining</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for Hazelcast C++ Client by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
